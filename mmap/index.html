<!DOCTYPE html>

<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<script type="text/javascript"
src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCBXytsTGPDgxCcgRFdOuLLj7yh2jInP40">
</script>
<script>
var map = null;
function initialize() {
    var mapOptions = {
center: { lat: 42.2846847,lng:-71.064473621 },
        zoom: 16
    };
    map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
    var geocoder = new google.maps.Geocoder();
    var pos = {lat:0, lng:0}
    geocoder.geocode({address:"Ashmont T Station"}, function(result, stat) 
            {
            pos = result[0].geometry.location;
            pos = {lat:pos.lat(), lng:pos.lng()};
            var marker = new google.maps.Marker({map:map, position:pos , icon:google.maps.CIRCLE});
            });
}
var xhr = new XMLHttpRequest();
xhr.open("POST", "http://chickenofthesea.herokuapp.com/sendLocation");
xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xhr.onload = function () {
    //console.log(xhr.responseText);
    people = JSON.parse(xhr.responseText);
    people.characters.map(function(person) {
            var marker = new google.maps.Marker({map:map, position:{lat:person.loc.latitude, lng:person.loc.longitude}, icon:person.name+'.png'}) 
            var infoWindow = new google.maps.InfoWindow(
                {content:"<h1>"+person.name+"</h1>"}
                );
            infoWindow.open(map, marker);
            })
}
xhr.send("login=PeterGriffin&lat=0.0&lng=0.0");

google.maps.event.addDomListener(window, 'load', initialize);
</script>
</head>
<body>
    <div id="map-canvas"></div>
</body>
</html>
